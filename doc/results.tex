% !TEX root = thesis.tex
%        File: preface.tex
%     Created: mån feb 12 01:00  2018 C
% Last Change: mån feb 12 01:00  2018 C
%
% TODO: write some contaning text, include only relevant plots. explain results.
In this chapter we will first present the results of the equilibration studies. Then the main computational results will be presented, first the determination of the scaling correction $\omega$, the determinaion of the critical temperature and finally the estimations of the critical exponents $\eta$ and $\nu$.
\section{Equilibration}

\section{Previous results}
\begin{table}[!htpb]
\begin{center}
\begin{tabular}{l l l l l}
  Quantity 	& MC\cite{Campostrini2006} 	& pseudo-$\varepsilon$\cite{Sokolov2016} & Space\cite{Lipa2003}	& MC\cite{Jeon2012} \\
  $T_c$		& 2.20184(6)			& N/A					&			& 2.20186(9)\\
  $\alpha $	& -0.0151(3)			& -0.0117(31)				&-0.0127(3)		& -0.0124(30)\\
  $\nu	  $     & 0.6717(1) 			& 0.6706(10)				&0.6709(2)		& 0.6708(5)\\
  $\eta   $     & 0.0381(2) 			& 0.0376(28) 				&			& \\
  $\gamma $	& 1.3178(2) 			& 1.3159(8)				&			& \\
  $\beta  $     & 0.3486(1) 			& 0.3479(16)				&			& \\
  $\delta $	& 4.780(1) 			& 					&			& \\
  $\omega $     & 0.785(20) 			& N/A					&			& \\
  $\omega_2$ 	& 1.8(2) 			& N/A					&			& \\
\end{tabular}
\end{center}
\caption{Here we present some of the recent and most precise result as well as our best estimates from this work }
\end{table}
Sokolov did pseudo-$\varepsilon$ expansion on 3DXY.\cite{Sokolov2016}
Lipa et al. did space stuff \cite{Lipa2003}
\begin{table}[!htpb]
\begin{center}
\begin{tabular}{l l l l}
  Quantity  & Hasenbusch & Conformal bootstrap& Our\\
  $T_c$	    & 4.511523(3)& N/A		& N/A\\
  $\alpha $ & N/A        & N/A		& N/A\\
  $\nu	  $ & 0.63002(10)& 0.629(1)	& N/A\\
  $\eta   $ & 0.03627(10)& 0.0341(5)	& N/A\\
  $\gamma $ & N/A        & N/A		& N/A\\
  $\delta $ & N/A        & N/A		& N/A\\
  $\beta  $ & N/A        & N/A		& N/A\\
  $\omega $ & N/A        & 0.80(1)	& N/A\\
  $\omega_2$& N/A        & N/A		& N/A\\
\end{tabular}
\end{center}
\caption{3D Ising-model }
\end{table}
Gliozzo used conformal bootstrap method on Ising 3D.\cite{Gliozzi2014}


\subsection{Data Analysis}
The simulation program outputs raw data ordered in lines. Data from one ``simulation'' is contained in $N_{temperatures} \cdot N_{averages per simulation} \cdot N_{simulations}$.
To calculate quantities of interest from this raw data, a python script has been written, utilizing the numpy library. All available raw data is loaded into a numpy ndarray, and sorted by system size and temperature. Then for each block of data with one temperature and one system size, combined averages are calculated and from these, further functions of the averages are calculated, such as the Binder Parameter, it's derivative, Susceptibility, Superfluid density, etc. To estimate the statistical error in these estimations, we utilize a resampling method called the jackknife method. For each block used in calculating the estimations, a jackknife function is called, which calculates the quantities again, but with a sub-block of data omitted.
\subsection{3DXY-model}
Simulations were performed using the Wolff-cluster algorithm at the temperature $T_{run} = 2.2020~K$. Histogram extrapolation was performed to extrapolate to the range of temperatures $T_{range} = 2.2015-2.2030 ~ K$.
The simulations are structured so that a lattice is initialized in the zero temperature state, all spins pointing in one direction. Then cluster-updates are performed until over 100k sweeps have been performed.

(We say that one sweep has been performed when a number of spins equal to the total number of spins on the lattice has been tested to be added to a cluster.
Thus the number of clusters and sweeps performed as warm-up varies slightly between independent simulations)

After the warm-up, cluster updates are performed for 100k more sweeps, and the thermodynamic quantities are collected after each update. Then, averages are calculated and printed. Then 100 sweeps are performed to take the lattice to a state not correlated, and another 100k sample sweeps are performed. This is repeated 100 times. The system sizes simulated are 4, 8, 16, 32, 64 and 128. 
The number of simulations currently used to calculate $U_4, \rho_s, \chi $ etc. for the system sizes 4


\begin{table}[htpb]
\begin{center}
\begin{tabular}{l l l}
  L & No. simulations & No. uncorrelated averages\\
  4 & 110 & 11000\\
  8 & 110 & 11000\\
  16 & 45.54 & 4554\\
  32 & 12 & 1200\\
  64 & 1.16 & 116 \\
  128 & 0  & 0 \\
\end{tabular}
\end{center}
\caption{Number of simulations performed on the 3DXY-model}
\end{table}

\begin{table}[htpb]
\begin{center}
\begin{tabular}{l l l}
  L & No. simulations & No. uncorrelated averages\\
  4 & 100 & 10000\\
  8 & 100 & 10000\\
  16 & 100 & 10000\\
  32 & 97.52 & 9752 \\
  64 & 5.8 & 580 \\
  128 & 1.15  & $115^{*}$ \\
\end{tabular}
\end{center}
\caption{Number of simulations performed on the 3D Ising-model}
\end{table}
\subsection{3D Ising-model}
The same general formula is used when simulating the 3D Ising-model, however, the temperature range is changed to capture the phase transition, $T_{\trm{run}} = 4.50, ~ T_{\trm{range}} = 4.486-4.515$.

\subsection{Figures}
We begin by plotting some bare quantities which we use in our further analysis.
\begin{figure}[!htpb]
  \centering
  \includegraphics[width=\textwidth]{./plots/3DXY/vsT/Susceptibility.eps}
  \caption{Plotted here is the susceptibility (per spin?), plotted for different system sizes as a function of temperature}
\end{figure}


%\input{figures.tex}
\begin{figure}[!htpb]
  \centering
  \label{fig:three_l_omega}
  \includegraphics[width=\textwidth]{./plots/3DXY/vsO/three_L_BinderCumuland.eps}
  \caption{Using three system sizes with a constant factor in size difference, one can directly compute the first order scaling correction $\omega$ as shown in \ref{three_l_omega}. The hope is that for large enough system sizes, this ansatz will be adequate to get a good estimation of omega.}
\end{figure}

\begin{figure}[!htpb]
  \centering
  \includegraphics[width=\textwidth]{./plots/3DXY/vsT/nu.eps}
  \caption{Here we plot $\nu$ obtained by fitting $\frac{dB}{dT}(L)$ for constant $T$, to a function $f = a*L^{1/\nu}(1+L^{-\omega})$ for a estimated value of $\omega$, and plot the result versus the temperature. }
\end{figure}

\begin{figure}[!htpb]
  \centering
  \includegraphics[width=\textwidth]{./plots/3DXY/vsT/eta.eps}
  \caption{The value of $\eta$ is plotted versus the temperature as obtained by fitting $\chi_T(L)$ to the scaling ansatz $f = a*L^{2-\eta}(1+L^{-\omega})$, where only $a$ and $\eta$ are unknown.  }
\end{figure}




\begin{figure}[!htpb]
  \centering
  \label{fig:omega_two_l}
  \includegraphics[width=\textwidth]{./plots/3DXY/vsT/omega.eps}
  \caption{By fitting $b''(L) = B(2L) - B(L)$ to a function $f = b'L^{-\omega}$, we get an intersection at $T=T_c$ and the y-value should give us $\omega$. Curve $n$ is defined by dropping the $n$ lowest values for $L$, so for $n = 3$, only the values for $L= 32,64,128$ are used. The same analysis can be performed using $L\rho_s$, but our statistics are not enough to give any meaningful output. The curves in this figure are somewhat similar to those of \ref{fig:three_l_omega}, but are in fact two quite different methods of calculating omega. }
\end{figure}

\begin{figure}[!htpb]
  \centering
  \includegraphics[width=\textwidth]{./plots/3DXY/vsT/variace_omega.eps}
  \caption{The variance $\omega$ from fitting $b''(L) = B(2L)-B(L)$ to $f = a*L^{-\omega}$, this gives a hint about what $T_c$ should be. By visual inspection of \ref{fig:omega_two_l} one would guess the same value for $T_c$ as the minimum here, which is nice. }
\end{figure}
