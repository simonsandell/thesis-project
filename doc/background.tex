% !TEX root = .righo/thesis.tex
%        File: preface.tex
%     Created: mån feb 12 01:00  2018 C
% Last Change: mån feb 12 01:00  2018 C
%
% TODO: Scaling and universality: more equations.
% scaling laws and definitions of critical exponents, maybe remove? maybe write some text. move to appendix or other place?
% There should be some parts about xy model and ising3d model here.
In this section we will describe the models we simulate using Monte Carlo, as well as establish some theoretical background to explain how physical information can be extracted from simulated systems with sizes $10^X$ times smaller than actual realizations of the transition studied in experiments.
\section{Models} % define equations, define quantities.
The goal of this thesis is to estimate the critical exponents of the lambda phase transition (\lpt) in $^4$He by Monte Carlo (MC) simulation of a model. 
The principle of Universality allows us to freely chose a model for our simulation as long as it is part of the same Universality Class as the \lpt, since all those models are guaranteed to have the exact same critical properties. 
The three criteria that define universality classes are the symmetry group of the order parameter, the physical dimensions and the range of the interactions.
The class of the lambda transition in $^4$He is represented by the symmetry group $O(2)$, short range interactions and $d=3$. With $d=2$ instead the class changes to that of the famous topological Kosterlitz-Thouless transition.

The model we use in our simulation is the so-called XY-model in 3 dimension and allowing only nearest neighbour interactions on a cubic lattice.
We employ periodic boundary conditions, so that the nearest neighbours of any given lattice site $\bm{s} = (x,y,z)$ is defined as 
\begin{align}
    \bm{n_{1,2}} &= (\trm{mod}(L+x\pm1), &   &y,                    &    z)&\\
    \bm{n_{3,4}} &= (x,                  &   &\trm{mod}(L+y\pm1),   &    z)&\\
    \bm{n_{5,6}} &= (x,                  &   &y,                    &    \trm{mod}(L+z\pm1))&
\end{align}
where the lattice indices $(x,y,z)$ range from $[0,L-1]$.

The Hamiltonian is written as 
\begin{equation}
  \label{xyham}
  H_{\trm{3DXY}} = -K\sum\limits_{\langle i,j\rangle} \bm{s_i}\cdot\bm{s_j} = -K\sum\limits_{\langle i,j\rangle} \cos(\alpha_i - \alpha_j)
\end{equation}
where $K$ is the coupling constant, which we during the rest of the thesis let $K=1$.
In the XY-model, the spins are confined to a plane, so they can be parametrized by $ \bm{s_1} = (\cos(\alpha_i),\sin(\alpha_i)$, hence the second equality in \ref{xyham}.

Next, we define some of the quantities which we calculate during simulation.
We define the magnetization as 
\begin{equation}
  M = \left| \sum_i \bm{s_i}\right|,
  \label{}
\end{equation}
the energy as 
\begin{equation}
  E = -\sum\limits_{\langle i,j \rangle} \cos(\alpha_i - \alpha_j),
  \label{}
\end{equation}
the superfluid stiffness/helicity modulus as 
\begin{equation}
  \Upsilon_{\bm{\mu}} = -\left\langle \sum_{\langle i,j\rangle} cos(\alpha_i - \alpha_j) (\hat{r_{i,j}}\cdot \bm{\mu})^2 \right\rangle - \frac{1}{T}\left\langle\left(\sum_{\langle i,j\rangle} \sin(\alpha_i - \alpha_j)(\bm{\epsilon_{i,j}}\cdot \bm{\mu})\right)^2\right\rangle
  \label{}
\end{equation}
The superfluid stiffness/density/helicity modulus is a quantity representing the shift in free energy introduced by applying a phase twist along a boundary of the system.
In the normal state, where the phase of the system is at large random, there will not be any change in free energy by such a twist, but in the superfluid state, the system is in a coherent state, and applying a twist at the boundary will propagate throughout the system. Thus the magnitude of the shift in free energy should be proportional to the total superfluid density.
The superfluid stiffness is defined by the following expression
\begin{align}
  \Delta F = \frac{1}{2}\rho_s(\varphi)^2\\
  \rho_s = \left. \frac{\pa^{2} f}{\pa \varphi^2}\right|_{\varphi =0}
  \label{}
\end{align}
where $f$ is the free energy density defined by
\begin{equation}
  f = L^{-d}F = -TL^{-d}\ln(Z)
  \label{}
\end{equation}
and 
\begin{equation}
  Z = \prodint \exp\left(-\beta H\right).
  \label{}
\end{equation}
$H$ is as defined above.
So, to calculate the difference we introduce a new Hamiltonian which is identical to the old, but for spins along a certain boundary, we add a term $\varphi$ for their neighbours in one direction, say for instance the positive x-direction.
\begin{equation}
  H_{\trm{twist}} = - \sum_{i\in\pa}\cos\left( \alpha_i - \alpha_{i+x} + \varphi \right)
  \label{}
\end{equation}
Here, $\sum_{i\in\pa}$ signifies that we only sum over spins on a certain boundary plane, and by $\alpha_{i+x}$ we mean the spin at location $(1,0,0)$ relative to spin $i$ at location $(x_i,y_i,z_i)$.

Note now that when we derive $\Delta f$, only the terms in $H - H_{\trm{twist}}$ at the boundary will remain.
Some partial results in our derivation of the usable expression for $\rho_s$ are
\begin{align}
  \frac{\pa Z[H_{\trm{twist}}]}{\pa (\varphi)} &=  \prodint \frac{\pa}{\pa (\varphi)}e^{ -\beta H_{\trm{twist}}} = \\
  &= \prodint (-\beta\sum\limits_{i\in\pa} \sin(\alpha_i - \alpha_{i+x} + \varphi))e^{ -\beta H_{\trm{twist}}} =\\
  &= -\beta\left\langle \sum_{i\in\pa}\sin(\alpha_i-\alpha_{i+x}+\varphi) \right\rangle = 0.
  \label{}
\end{align}
\begin{align}
  \frac{\pa^2 Z[H_{\trm{twist}}]}{\pa (\varphi)^2} &= \prodint \frac{\pa}{\pa (\varphi)}\left[\left(-\beta\sum_{i\in\pa}\sin(\alpha_i - \alpha_{i+x} + \varphi)\right)e^{ -\beta H_{\trm{twist}}}\right] =\\
  &= \prodint\Bigg[ \left\{-\beta\sum_{i\in\pa}\cos(\alpha_i - \alpha_{i+x} + \varphi) + \beta^2\left(\sum_{i\in\pa}\sin(\alpha_i - \alpha_{i+x} + \varphi)\right)^2\right\}\\
  &\times e^{ -\beta H_{\trm{twist}}} \Bigg] = -\beta\left\langle \sum_{i\in\pa}\cos(\alpha_i -\alpha{i+x} +\varphi) \right\rangle +\\
  &+ \beta^2 \left\langle \left(\sum_{i\in\pa} \sin(\alpha_i - \alpha_{i+x}+\varphi)\right)^2\right\rangle
  \label{}
\end{align}

Now we start the derivation:
\begin{align}
  \rho_s &= \left.\frac{\pa^2 \Delta f}{\pa( \varphi)^2}\right|_{\varphi=0} = \frac{1}{L^d}\frac{\pa^2}{}
  \label{}
\end{align}


To improve statistical results, we compute $\Upsilon_{\bm{\mu}}$ for $\bm{\mu} = \bm{\hat{x}},\bm{\hat{y}},\bm{\hat{z}}$.

In the regular liquid phase, the energy of the system is unaffected by uniform boundary motion. The superfluid stiffness is a quantity which measures the shift in energy due to a shift of the angles along a boundary.

The helicity modulus $\Upsilon(T)$ is a measure of the system to a ``phase twisting'' field, for a superfluid system the helicity modulus is related to the superfluid density
$\rho_s = (m/\hbar)^2 \Upsilon(T)$.
Fischer et al showed in 1973 that this quantity can be calculated within the framework of equilibrium statistical mechanics, but one need to go beyond bulk properties.
Operational definition for spherical model (1952 Barber Fischer) and ideal Bose gas (Barber 1977) under periodic and anti-periodic boundary conditions, ($F^{0},F^{1/2}$) :
\begin{equation}
  \Upsilon(T) = \trm{lim}_{L\rightarrow \infty} (2L^2/\pi^2) (F^{1/2} (T;L)-F^0(T;L)).
  \label{}
\end{equation}
Rudnick Jasnow (1977) operational definition: 
\begin{equation}
  \Upsilon(T) = \left. \frac{  \pa^2F(T;k_0)}{\pa k^2_0}\right|_{k_0 =0}
  \label{}
\end{equation}
Thought: the boundary conditions induce a long wavelength twist of the wave-number $k_0$ of the order parameter.
Showed that Josephson relation ($\nu = 2\beta -\eta\nu = 2 - \alpha -2\nu = (d -2)\nu$) (1966) is exact using this definition and epsilon-expansion.
The superfluid density is in the thermodynamic limit a constant at $T_c$.



\section{Finite size scaling}
Consider a system with a set of coupling constants $[K]$ and linear finite size $L$. 
The singular part of the free energy scales as
\begin{equation}
  f_s([K],L^{-1}) = l^{-d}f_s([K],lL^{-1}).
  \label{}
\end{equation}
Close to a fixed point of the RG, we can write this equation in terms of right eigenvectors of the linearised RG-transform,
\begin{equation}
  f_s(t,h,K_3,\cdots,L^{-1}) = l^{-d}f_s(tl^{y_t},hl^{y_h},K_3 l^{y_3},\cdots,lL^{-1}).
  \label{}
\end{equation}
It is evident that the inverse size of the system is in fact a relevant eigenvector with eigenvalue $y_L = 1$, and only becomes irrelevant in the thermodynamic limit $L^{-1}\rightarrow 0$.
The models we study in this paper have the external field set to zero, if we let the scaling parameter $l = L$, we can write the scaling form of the free energy as
\begin{equation}
  f_s(t,L^{-1}) = L^{-d} F_f(t L^{1/\nu})
  \label{}
\end{equation}
where we used $\nu = 1/y_t$ and the scaling law $2 -\alpha = d\nu$.
$F_f(tL^{1/\nu})$ is the form function for the free energy.
From this equation we can derive the finite size scaling behaviour of any physical quantities by utilizing their relation to the free energy. 
For example, we can find the scaling form of the specific heat as
\begin{equation}
  c_V = \frac{\partial ^2 f_s}{\partial t^2} \sim L^{-d +2/\nu}F_{c}(tL^{1/\nu}) = L^{\alpha/\nu} F_{c}(tL^{1/\nu}).
  \label{}
\end{equation}
This form function will have a maximum at some shifted value of $T$, 
\begin{equation}
  T_c(L) = T_c +  a_0 L^{-1/\nu}.
  \label{}
\end{equation}


Similarly for the susceptibility,
\begin{align}
  \chi = \frac{\partial^2 f}{\partial h^2}
  \sim L^{-d +2y_h}F_{\chi}(tL^{1/\nu}) = L^{2-\eta}F_{\chi}(tL^{1/\nu})
  \label{}
\end{align}
where we used that $ 2(d-y_h) = d -2 +\eta$.
The magnetization goes as
\begin{equation}
  M = \frac{\partial f}{\partial h} \sim L^{-d + y_h} = L^{-\beta/\nu}
  \label{}
\end{equation}

These relations are only correct in the limit $t= \frac{T-T_c}{T_c} \rightarrow 0$ or equivalently $L^{-1/\nu} \rightarrow 0$.
The irrelevant coupling constants will contribute to the averages close but at the critical point.
To correct for these contributions, there are many methods. Hasenbusch employ so-called improved models, which by definition eliminates the first order irrelevant contribution.
This method has some merit as there is theoretical evidence that multiple next-to-leading order irrelevant contributions all scale with an exponent $y_{irr} \approx -2$.
In this thesis we instead use the plain 3DXY-model and use the ansatz that only the leading order correction, $\omega = -y_3/\nu$, will be necessary to gain accurate estimations of the critical exponents.
\section{Scaling laws}
From renormalization-group theory we learn that there only exist two independent critical exponents from which all the others are derived.
This was not a surprise, in fact, it was foreshadowed by the many scaling laws proposed both from prior theory and experiments.
The framework of renormalization-group define the two independent exponents as the eigenvalues of rescaling operators.
Here we state the various relations between exponents and their definitions in terms of limiting behaviour of physical quantities.
\begin{align}
  y_t &= \frac{1}{\nu}\\
  y_h &= \frac{2-\eta +d}{2}\\
  \Delta &= y_h/y_t\\
	2 - \eta &= \frac{\gamma}{\nu} = d\frac{\delta -1}{\delta+1}\\
	\nu d &= 2-\alpha = 2\beta + \gamma = \beta(\delta+1) = \gamma\frac{\delta +1}{\delta -1}
\end{align}
\section{Definitions of critical exponents}
\begin{align}
  C &\sim t^{-\alpha}, & &h=0\\
  M &\sim (-t)^{\beta} & &h=0\\
  \chi &\sim |t|^{-\gamma} & &h=0\\
  \xi &\sim |t|^{-\nu} & &h=0\\
  h &\sim m^{\delta} & &t=0\\
  \langle m(r)m(0)\rangle &\sim r^{-d +2 -\eta} & &t=0
  \label{}
\end{align}
